{"ast":null,"code":"import _regeneratorRuntime from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import config from\"../config\";import Cookie from\"js-cookie\";import{FormGroup,Grid,Row,Col,PageHeader,ListGroup}from\"react-bootstrap\";import LoaderButton from\"../components/LoaderButton\";import\"./Archives.css\";export default function Archives(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),staple=_useState2[0],setStaple=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),staples=_useState4[0],setStaples=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isDeleting=_useState6[0],setIsDeleting=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];useEffect(function(){function onLoad(){return _regeneratorRuntime.async(function onLoad$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);try{fetch(config.HOST+\"/rest/api/1/staple/archive\",{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){return response.json();}).then(function(data){return setStaples(data);}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}setIsLoading(false);case 3:case\"end\":return _context.stop();}}});}onLoad();},[props.match.params.id]);function handleDelete(id){return _regeneratorRuntime.async(function handleDelete$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsDeleting(true);try{fetch(config.HOST+\"/rest/api/1/staple/\".concat(id),{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){if(response.ok){setIsDeleting(false);setStaple({});window.location.reload();}}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}finally{setIsDeleting(false);}case 2:case\"end\":return _context2.stop();}}});}function fetchStaple(id){try{fetch(config.HOST+\"/rest/api/1/staple/\".concat(id),{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){return response.json();}).then(function(data){return setStaple(data);}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}}function renderArchiveView(astaples){var list=undefined;if(astaples.staples){list=astaples.staples.map(function(staple){return React.createElement(\"div\",{key:staple.id,className:\"archive-list\"},React.createElement(\"div\",{key:staple.id},React.createElement(\"a\",{onClick:function onClick(){return fetchStaple(staple.id);}},staple.name),React.createElement(\"br\",null),\"Created: \"+new Date(staple.created_at).toLocaleString()));});}var s=undefined;if(staple.staple){s=React.createElement(\"div\",{className:\"Staples\"},React.createElement(\"form\",null,React.createElement(FormGroup,{controlId:\"content\",className:\"staple-view\"},React.createElement(\"pre\",null,staple.staple.content)),React.createElement(LoaderButton,{block:true,bsSize:\"large\",bsStyle:\"danger\",onClick:function onClick(){return handleDelete(staple.staple.id);},isLoading:isDeleting},\"Delete\")),React.createElement(\"br\",null));}else{s=React.createElement(\"div\",{className:\"Staples\"},React.createElement(\"form\",null,React.createElement(FormGroup,{controlId:\"content\",className:\"staple-view\"},React.createElement(\"pre\",null,\"No archived staples.\"))),React.createElement(\"br\",null));}return React.createElement(\"div\",null,React.createElement(Grid,null,React.createElement(Row,{className:\"show-grid\"},React.createElement(Col,{xs:12,md:8},s),React.createElement(Col,{xs:6,md:4},list))));}function renderArchives(){return React.createElement(\"div\",{className:\"staples\"},React.createElement(PageHeader,null,\"Your Archived Staples\"),React.createElement(ListGroup,null,!isLoading&&renderArchiveView(staples)));}return React.createElement(\"div\",{className:\"Staples\"},renderArchives());}","map":{"version":3,"sources":["/Users/skarlso/goprojects/staple/frontend/src/containers/Archives.js"],"names":["React","useState","useEffect","config","Cookie","FormGroup","Grid","Row","Col","PageHeader","ListGroup","LoaderButton","Archives","props","staple","setStaple","staples","setStaples","isDeleting","setIsDeleting","isLoading","setIsLoading","onLoad","fetch","HOST","method","headers","get","then","response","json","data","catch","e","alert","message","match","params","id","handleDelete","ok","window","location","reload","fetchStaple","renderArchiveView","astaples","list","undefined","map","name","Date","created_at","toLocaleString","s","content","renderArchives"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport config from \"../config\";\nimport Cookie from \"js-cookie\";\nimport {FormGroup, Grid, Row, Col, PageHeader, ListGroup} from \"react-bootstrap\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport \"./Archives.css\";\n\nexport default function Archives(props) {\n  const [staple, setStaple] = useState({});\n  const [staples, setStaples] = useState([]);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    async function onLoad() {\n      setIsLoading(true);\n      try {\n        fetch(config.HOST+\"/rest/api/1/staple/archive\", {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer ' + Cookie.get('token'),\n          },\n        }).then(response => response.json())\n          .then(data => setStaples(data))\n          .catch(e => alert(e.message));\n      } catch (e) {\n        alert(e);\n      }\n      setIsLoading(false);\n    }\n    onLoad();\n  }, [props.match.params.id]);\n\n  async function handleDelete(id) {\n    setIsDeleting(true);\n    try {\n      fetch(config.HOST+`/rest/api/1/staple/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + Cookie.get('token'),\n        },\n      }).then(response => {\n        if (response.ok) {\n          setIsDeleting(false);\n          setStaple({});\n          window.location.reload();\n        }\n      }).catch(e => alert(e.message));\n    } catch (e) {\n      alert(e);\n    } finally {\n      setIsDeleting(false);\n    }\n  }\n\n  function fetchStaple(id) {\n    try {\n      fetch(config.HOST+`/rest/api/1/staple/${id}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + Cookie.get('token'),\n        },\n      }).then(response => response.json())\n        .then(data => setStaple(data))\n        .catch(e => alert(e.message));\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  function renderArchiveView(astaples) {\n    let list = undefined;\n    if (astaples.staples) {\n      list = astaples.staples.map(staple => {\n        return (<div key={staple.id} className=\"archive-list\">\n          <div key={staple.id}>\n            {/* eslint-disable-next-line jsx-a11y/anchor-is-valid */}\n            <a onClick={() => fetchStaple(staple.id)} >{staple.name}</a><br/>\n            {\"Created: \" + new Date(staple.created_at).toLocaleString()}\n          </div>\n        </div>)\n      })\n    }\n    let s = undefined;\n    if (staple.staple) {\n      s = (\n        <div className=\"Staples\">\n          <form>\n            <FormGroup controlId=\"content\" className=\"staple-view\">\n              <pre>{staple.staple.content}</pre>\n            </FormGroup>\n            <LoaderButton\n              block\n              bsSize=\"large\"\n              bsStyle=\"danger\"\n              onClick={() => handleDelete(staple.staple.id)}\n              isLoading={isDeleting}\n            >\n              Delete\n            </LoaderButton>\n          </form>\n          <br/>\n        </div>\n      )\n    } else {\n      s = (\n        <div className=\"Staples\">\n          <form>\n            <FormGroup controlId=\"content\" className=\"staple-view\">\n              <pre>No archived staples.</pre>\n            </FormGroup>\n          </form>\n          <br/>\n        </div>\n      )\n    }\n    return (\n      <div>\n        <Grid>\n          <Row className=\"show-grid\">\n            <Col xs={12} md={8}>\n              {s}\n            </Col>\n            <Col xs={6} md={4}>\n              {list}\n            </Col>\n          </Row>\n        </Grid>\n      </div>\n    )\n  }\n\n  function renderArchives() {\n    return (\n      <div className=\"staples\">\n        <PageHeader>Your Archived Staples</PageHeader>\n        <ListGroup>\n          {!isLoading && renderArchiveView(staples)}\n        </ListGroup>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"Staples\">\n      {renderArchives()}\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}