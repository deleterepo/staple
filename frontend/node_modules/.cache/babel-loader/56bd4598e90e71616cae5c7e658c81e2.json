{"ast":null,"code":"import _regeneratorRuntime from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Col,FormGroup,Grid,ListGroup,ListGroupItem,PageHeader,Row}from\"react-bootstrap\";import{LinkContainer}from\"react-router-bootstrap\";import\"./Home.css\";import config from\"../config\";import Cookie from\"js-cookie\";import LoaderButton from\"../components/LoaderButton\";export default function Home(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),staples=_useState2[0],setStaples=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),nextStaple=_useState4[0],setNextStaple=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isArchiving=_useState8[0],setIsArchiving=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isDeleting=_useState10[0],setIsDeleting=_useState10[1];function handleArchive(event,id){setIsLoading(true);event.preventDefault();try{fetch(config.HOST+\"/rest/api/1/staple/\".concat(id,\"/archive\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){if(response.ok){setIsArchiving(false);props.history.push('/');}}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}}function handleDelete(event,id){setIsDeleting(true);event.preventDefault();try{fetch(config.HOST+\"/rest/api/1/staple/\".concat(id),{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){if(response.ok){setIsDeleting(false);props.history.push('/');}}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}}function renderStapleView(astaples){var list=undefined;if(astaples.staples){list=astaples.staples.map(function(staple){return React.createElement(\"div\",{key:staple.id,className:\"staple-list\"},React.createElement(\"strong\",null,\"Name: \"+staple.name),React.createElement(\"br\",null),\"Created: \"+new Date(staple.created_at).toLocaleString());});}var s=undefined;if(nextStaple.staple){s=React.createElement(\"div\",{className:\"Staples\"},React.createElement(\"form\",null,React.createElement(FormGroup,{controlId:\"content\",className:\"staple-view\"},React.createElement(\"pre\",null,nextStaple.staple.content)),React.createElement(LoaderButton,{block:true,bsSize:\"large\",bsStyle:\"info\",onClick:function onClick(event){return handleArchive(event,nextStaple.staple.id);},isLoading:isArchiving,className:\"archive-button\"},\"Archive\"),React.createElement(LoaderButton,{block:true,bsSize:\"large\",bsStyle:\"info\",onClick:function onClick(event){return handleDelete(event,nextStaple.staple.id);},isLoading:isDeleting,className:\"delete-button\"},\"Delete\")),React.createElement(\"br\",null));}return React.createElement(\"div\",null,React.createElement(Grid,null,React.createElement(Row,{className:\"show-grid\"},React.createElement(Col,{xs:12,md:8},s),React.createElement(Col,{xs:6,md:4},list))),React.createElement(LinkContainer,{key:\"new\",to:\"/staples/new\",className:\"create-container\"},React.createElement(ListGroupItem,null,React.createElement(\"h4\",null,React.createElement(\"b\",null,\"\\uFF0B\"),\" Create a new staple\"))));}function renderLander(){return React.createElement(\"div\",{className:\"lander\"},React.createElement(\"h1\",null,\"Staple\"),React.createElement(\"p\",null,\"A stack based bookmark.\"));}function renderStaples(){return React.createElement(\"div\",{className:\"staples\"},React.createElement(PageHeader,null,\"Your Staples\"),React.createElement(ListGroup,null,!isLoading&&renderStapleView(staples)));}useEffect(function(){function onLoad(){return _regeneratorRuntime.async(function onLoad$(_context){while(1){switch(_context.prev=_context.next){case 0:if(props.isAuthenticated){_context.next=2;break;}return _context.abrupt(\"return\");case 2:try{fetch(config.HOST+\"/rest/api/1/staple\",{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){return response.json();}).then(function(data){return setStaples(data);}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}try{fetch(config.HOST+\"/rest/api/1/staple/next\",{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+Cookie.get('token')}}).then(function(response){return response.json();}).then(function(data){return setNextStaple(data);}).catch(function(e){return alert(e.message);});}catch(e){alert(e);}setIsLoading(false);case 5:case\"end\":return _context.stop();}}});}onLoad();},[props.isAuthenticated,isLoading,isDeleting]);return React.createElement(\"div\",{className:\"Home\"},props.isAuthenticated?renderStaples():renderLander());}","map":{"version":3,"sources":["/Users/skarlso/goprojects/staple/frontend/src/containers/Home.js"],"names":["React","useEffect","useState","Col","FormGroup","Grid","ListGroup","ListGroupItem","PageHeader","Row","LinkContainer","config","Cookie","LoaderButton","Home","props","staples","setStaples","nextStaple","setNextStaple","isLoading","setIsLoading","isArchiving","setIsArchiving","isDeleting","setIsDeleting","handleArchive","event","id","preventDefault","fetch","HOST","method","headers","get","then","response","ok","history","push","catch","e","alert","message","handleDelete","renderStapleView","astaples","list","undefined","map","staple","name","Date","created_at","toLocaleString","s","content","renderLander","renderStaples","onLoad","isAuthenticated","json","data"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {Col, FormGroup, Grid, ListGroup, ListGroupItem, PageHeader, Row} from \"react-bootstrap\";\nimport {LinkContainer} from \"react-router-bootstrap\";\nimport \"./Home.css\";\nimport config from \"../config\";\nimport Cookie from \"js-cookie\";\nimport LoaderButton from \"../components/LoaderButton\";\n\nexport default function Home(props) {\n  const [staples, setStaples] = useState([]);\n  const [nextStaple, setNextStaple] = useState({});\n  const [isLoading, setIsLoading] = useState(true);\n  const [isArchiving, setIsArchiving] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  function handleArchive(event, id) {\n    setIsLoading(true);\n    event.preventDefault();\n    try {\n      fetch(config.HOST+`/rest/api/1/staple/${id}/archive`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + Cookie.get('token'),\n        },\n      }).then(response => {\n        if (response.ok) {\n          setIsArchiving(false);\n          props.history.push('/')\n        }\n      }).catch(e => alert(e.message));\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  function handleDelete(event, id) {\n    setIsDeleting(true);\n    event.preventDefault();\n    try {\n      fetch(config.HOST+`/rest/api/1/staple/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + Cookie.get('token'),\n        },\n      }).then(response => {\n        if (response.ok) {\n          setIsDeleting(false);\n          props.history.push('/')\n        }\n      }).catch(e => alert(e.message));\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  function renderStapleView(astaples) {\n    let list = undefined;\n    if (astaples.staples) {\n      list = astaples.staples.map(staple => {\n        return (\n          <div key={staple.id} className=\"staple-list\">\n            <strong>{\"Name: \" + staple.name}</strong><br/>\n            {\"Created: \" + new Date(staple.created_at).toLocaleString()}\n          </div>\n        )\n      })\n    }\n    let s = undefined;\n    if (nextStaple.staple) {\n      s = (\n        <div className=\"Staples\">\n          <form>\n            <FormGroup controlId=\"content\" className=\"staple-view\">\n              <pre>{nextStaple.staple.content}</pre>\n            </FormGroup>\n            <LoaderButton\n              block\n              bsSize=\"large\"\n              bsStyle=\"info\"\n              onClick={(event) => handleArchive(event, nextStaple.staple.id)}\n              isLoading={isArchiving}\n              className=\"archive-button\"\n            >\n              Archive\n            </LoaderButton>\n            <LoaderButton\n              block\n              bsSize=\"large\"\n              bsStyle=\"info\"\n              onClick={(event) => handleDelete(event, nextStaple.staple.id)}\n              isLoading={isDeleting}\n              className=\"delete-button\"\n            >\n              Delete\n            </LoaderButton>\n          </form>\n          <br/>\n        </div>\n      )\n    }\n    return (\n      <div>\n        <Grid>\n          <Row className=\"show-grid\">\n            <Col xs={12} md={8}>\n              {s}\n            </Col>\n            <Col xs={6} md={4}>\n              {list}\n            </Col>\n          </Row>\n        </Grid>\n        <LinkContainer key=\"new\" to=\"/staples/new\" className=\"create-container\">\n          <ListGroupItem>\n            <h4>\n              <b>{\"\\uFF0B\"}</b> Create a new staple\n            </h4>\n          </ListGroupItem>\n        </LinkContainer>\n      </div>\n    )\n  }\n\n  function renderLander() {\n    return (\n      <div className=\"lander\">\n        <h1>Staple</h1>\n        <p>A stack based bookmark.</p>\n      </div>\n    );\n  }\n\n  function renderStaples() {\n    return (\n      <div className=\"staples\">\n        <PageHeader>Your Staples</PageHeader>\n        <ListGroup>\n          {!isLoading && renderStapleView(staples)}\n        </ListGroup>\n      </div>\n    );\n  }\n\n  useEffect(() => {\n    async function onLoad() {\n      if (!props.isAuthenticated) {\n        return;\n      }\n\n      try {\n        fetch(config.HOST+\"/rest/api/1/staple\", {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer ' + Cookie.get('token'),\n          },\n        }).then(response => response.json())\n          .then(data => setStaples(data))\n          .catch(e => alert(e.message));\n      } catch (e) {\n        alert(e);\n      }\n\n      try {\n        fetch(config.HOST+\"/rest/api/1/staple/next\", {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer ' + Cookie.get('token'),\n          },\n        }).then(response => response.json())\n          .then(data => setNextStaple(data))\n          .catch(e => alert(e.message));\n      } catch (e) {\n        alert(e);\n      }\n\n      setIsLoading(false);\n    }\n\n    onLoad();\n  }, [props.isAuthenticated, isLoading, isDeleting]);\n\n  return (\n    <div className=\"Home\">\n      {props.isAuthenticated ? renderStaples() : renderLander()}\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}