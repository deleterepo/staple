{"ast":null,"code":"import _regeneratorRuntime from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/skarlso/goprojects/staple/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Routes from\"./Routes\";import{Link,withRouter}from\"react-router-dom\";import{Nav,Navbar,NavItem}from\"react-bootstrap\";import{LinkContainer}from\"react-router-bootstrap\";import\"./App.css\";import Cookie from\"js-cookie\";function App(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAuthenticated=_useState2[0],userHasAuthenticated=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isAuthenticating=_useState4[0],setIsAuthenticating=_useState4[1];useEffect(function(){onLoad();},[]);function onLoad(){return _regeneratorRuntime.async(function onLoad$(_context){while(1){switch(_context.prev=_context.next){case 0:try{if(Cookie.get('token')){userHasAuthenticated(true);}}catch(e){if(e!=='No current user'){alert(e);}}setIsAuthenticating(false);case 2:case\"end\":return _context.stop();}}});}function handleLogout(){return _regeneratorRuntime.async(function handleLogout$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// await Auth.signOut();\n// Clear cookie from session store.\nCookie.remove(\"token\");userHasAuthenticated(false);props.history.push(\"/login\");case 3:case\"end\":return _context2.stop();}}});}return!isAuthenticating&&React.createElement(\"div\",{className:\"App container\"},React.createElement(Navbar,{fluid:true,collapseOnSelect:true,className:\"navbar\"},React.createElement(Navbar.Header,null,React.createElement(Navbar.Brand,null,React.createElement(Link,{to:\"/\"},\"Staple\")),React.createElement(Navbar.Toggle,null)),React.createElement(Navbar.Collapse,null,React.createElement(Nav,{pullRight:true},isAuthenticated?React.createElement(React.Fragment,null,React.createElement(LinkContainer,{to:\"/settings\"},React.createElement(NavItem,null,\"Settings\")),React.createElement(LinkContainer,{to:\"/archive\"},React.createElement(NavItem,null,\"Archives\")),React.createElement(NavItem,{onClick:handleLogout},\"Logout\")):React.createElement(React.Fragment,null,React.createElement(LinkContainer,{to:\"/signup\"},React.createElement(NavItem,null,\"Signup\")),React.createElement(LinkContainer,{to:\"/login\"},React.createElement(NavItem,null,\"Login\")),React.createElement(LinkContainer,{to:\"/reset\"},React.createElement(NavItem,null,\"Reset Password\")))))),React.createElement(Routes,{appProps:{isAuthenticated:isAuthenticated,userHasAuthenticated:userHasAuthenticated}}));}export default withRouter(App);","map":{"version":3,"sources":["/Users/skarlso/goprojects/staple/frontend/src/App.js"],"names":["React","useState","useEffect","Routes","Link","withRouter","Nav","Navbar","NavItem","LinkContainer","Cookie","App","props","isAuthenticated","userHasAuthenticated","isAuthenticating","setIsAuthenticating","onLoad","get","e","alert","handleLogout","remove","history","push"],"mappings":"uTAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,GAAT,CAAcC,MAAd,CAAsBC,OAAtB,KAAqC,iBAArC,CACA,OAASC,aAAT,KAA8B,wBAA9B,CACA,MAAO,WAAP,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CAEA,QAASC,CAAAA,GAAT,CAAaC,KAAb,CAAoB,eAC8BX,QAAQ,CAAC,KAAD,CADtC,wCACXY,eADW,eACMC,oBADN,8BAE8Bb,QAAQ,CAAC,IAAD,CAFtC,yCAEXc,gBAFW,eAEOC,mBAFP,eAIlBd,SAAS,CAAC,UAAM,CACde,MAAM,GACP,CAFQ,CAEN,EAFM,CAAT,CAIA,QAAeA,CAAAA,MAAf,mHACE,GAAI,CACF,GAAIP,MAAM,CAACQ,GAAP,CAAW,OAAX,CAAJ,CAAyB,CACvBJ,oBAAoB,CAAC,IAAD,CAApB,CACD,CACF,CACD,MAAMK,CAAN,CAAS,CACP,GAAIA,CAAC,GAAK,iBAAV,CAA6B,CAC3BC,KAAK,CAACD,CAAD,CAAL,CACD,CACF,CAEDH,mBAAmB,CAAC,KAAD,CAAnB,CAZF,8CAeA,QAAeK,CAAAA,YAAf,4HACE;AACA;AACAX,MAAM,CAACY,MAAP,CAAc,OAAd,EACAR,oBAAoB,CAAC,KAAD,CAApB,CAEAF,KAAK,CAACW,OAAN,CAAcC,IAAd,CAAmB,QAAnB,EANF,+CASA,MACE,CAACT,gBAAD,EACA,2BAAK,SAAS,CAAC,eAAf,EACE,oBAAC,MAAD,EAAQ,KAAK,KAAb,CAAc,gBAAgB,KAA9B,CAA+B,SAAS,CAAC,QAAzC,EACE,oBAAC,MAAD,CAAQ,MAAR,MACE,oBAAC,MAAD,CAAQ,KAAR,MACE,oBAAC,IAAD,EAAM,EAAE,CAAC,GAAT,WADF,CADF,CAIE,oBAAC,MAAD,CAAQ,MAAR,MAJF,CADF,CAOE,oBAAC,MAAD,CAAQ,QAAR,MACE,oBAAC,GAAD,EAAK,SAAS,KAAd,EACGF,eAAe,CAEV,wCACE,oBAAC,aAAD,EAAe,EAAE,CAAC,WAAlB,EACE,oBAAC,OAAD,iBADF,CADF,CAIE,oBAAC,aAAD,EAAe,EAAE,CAAC,UAAlB,EACE,oBAAC,OAAD,iBADF,CAJF,CAOE,oBAAC,OAAD,EAAS,OAAO,CAAEQ,YAAlB,WAPF,CAFU,CAYZ,wCACE,oBAAC,aAAD,EAAe,EAAE,CAAC,SAAlB,EACE,oBAAC,OAAD,eADF,CADF,CAIE,oBAAC,aAAD,EAAe,EAAE,CAAC,QAAlB,EACE,oBAAC,OAAD,cADF,CAJF,CAOE,oBAAC,aAAD,EAAe,EAAE,CAAC,QAAlB,EACE,oBAAC,OAAD,uBADF,CAPF,CAbN,CADF,CAPF,CADF,CAqCE,oBAAC,MAAD,EAAQ,QAAQ,CAAE,CAAER,eAAe,CAAfA,eAAF,CAAmBC,oBAAoB,CAApBA,oBAAnB,CAAlB,EArCF,CAFF,CA0CD,CAED,cAAeT,CAAAA,UAAU,CAACM,GAAD,CAAzB","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Routes from \"./Routes\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { Nav, Navbar, NavItem } from \"react-bootstrap\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport \"./App.css\";\nimport Cookie from \"js-cookie\";\n\nfunction App(props) {\n  const [isAuthenticated, userHasAuthenticated] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(true);\n  \n  useEffect(() => {\n    onLoad();\n  }, []);\n  \n  async function onLoad() {\n    try {\n      if (Cookie.get('token')) {\n        userHasAuthenticated(true);\n      }\n    }\n    catch(e) {\n      if (e !== 'No current user') {\n        alert(e);\n      }\n    }\n  \n    setIsAuthenticating(false);\n  }\n\n  async function handleLogout() {\n    // await Auth.signOut();\n    // Clear cookie from session store.\n    Cookie.remove(\"token\");\n    userHasAuthenticated(false);\n    \n    props.history.push(\"/login\");\n  }\n\n  return (\n    !isAuthenticating &&\n    <div className=\"App container\">\n      <Navbar fluid collapseOnSelect className=\"navbar\">\n        <Navbar.Header>\n          <Navbar.Brand>\n            <Link to=\"/\">Staple</Link>\n          </Navbar.Brand>\n          <Navbar.Toggle />\n        </Navbar.Header>\n        <Navbar.Collapse>\n          <Nav pullRight>\n            {isAuthenticated\n              ? (\n                  <>\n                    <LinkContainer to=\"/settings\">\n                      <NavItem>Settings</NavItem>\n                    </LinkContainer>\n                    <LinkContainer to=\"/archive\">\n                      <NavItem>Archives</NavItem>\n                    </LinkContainer>\n                    <NavItem onClick={handleLogout}>Logout</NavItem>\n                  </>\n                )\n              : <>\n                  <LinkContainer to=\"/signup\">\n                    <NavItem>Signup</NavItem>\n                  </LinkContainer>\n                  <LinkContainer to=\"/login\">\n                    <NavItem>Login</NavItem>\n                  </LinkContainer>\n                  <LinkContainer to=\"/reset\">\n                    <NavItem>Reset Password</NavItem>\n                  </LinkContainer>\n                </>\n            }\n          </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n      <Routes appProps={{ isAuthenticated, userHasAuthenticated }} />\n    </div>\n  );\n}\n\nexport default withRouter(App);"]},"metadata":{},"sourceType":"module"}